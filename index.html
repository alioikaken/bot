<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Genius Market - Ultimate Pay</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg: #050608;
            --surface: #0f111a;
            --border: rgba(255, 255, 255, 0.07);
            --accent: #ff8c00;
            --kaspi: #f14635;
            --stars: #62bcf9;
            --crypto: #0088cc;
            --text: #ffffff;
            --text-dim: #83899f;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: 'Manrope', sans-serif; }

        body {
            background: var(--bg);
            color: var(--text);
            margin: 0;
            padding-bottom: 120px;
            overflow-x: hidden;
        }

        /* --- HEADER --- */
        .header {
            padding: 18px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(5, 6, 8, 0.85);
            backdrop-filter: blur(20px);
            position: sticky;
            top: 0; z-index: 1000;
            border-bottom: 1px solid var(--border);
        }

        .balance-chip {
            background: var(--surface);
            border: 1px solid var(--border);
            padding: 7px 14px;
            border-radius: 14px;
            display: flex; align-items: center; gap: 8px;
        }

        /* --- PAGES --- */
        .page { display: none; padding: 0 20px; animation: fadeIn 0.4s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .section-label { margin: 25px 0 15px; font-size: 12px; text-transform: uppercase; color: var(--text-dim); letter-spacing: 1px; }

        /* --- CARDS --- */
        .card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 12px;
            display: flex; align-items: center; justify-content: space-between;
        }

        .p-icon { width: 50px; height: 50px; border-radius: 14px; display: flex; align-items: center; justify-content: center; font-size: 22px; background: rgba(255,255,255,0.03); }

        .price-text { font-weight: 800; color: var(--accent); font-size: 16px; }

        .buy-btn { background: var(--text); color: var(--bg); border: none; padding: 8px 16px; border-radius: 10px; font-size: 11px; font-weight: 800; }

        /* --- MODAL PAYMENTS --- */
        .modal-wrap {
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9);
            backdrop-filter: blur(15px); z-index: 2000; align-items: flex-end;
        }
        .modal-view {
            background: #0a0b12; width: 100%; border-radius: 30px 30px 0 0;
            padding: 25px; border-top: 1px solid var(--border);
            transform: translateY(100%); transition: 0.3s ease;
        }
        .modal-wrap.active .modal-view { transform: translateY(0); }

        .pay-option {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 18px;
            padding: 16px;
            margin-bottom: 10px;
            display: flex; align-items: center; gap: 15px;
            transition: 0.2s;
        }

        .pay-option:active { border-color: var(--accent); background: rgba(255, 140, 0, 0.05); }

        .pay-icon { width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px; }
        
        .kaspi-bg { background: var(--kaspi); color: white; }
        .stars-bg { background: var(--stars); color: white; }
        .crypto-bg { background: var(--crypto); color: white; }

        .pay-info b { display: block; font-size: 14px; }
        .pay-info span { font-size: 11px; color: var(--text-dim); }

        /* --- KASPI SPECIFIC --- */
        #kaspi-checkout { display: none; text-align: center; padding: 10px; }
        .copy-box { background: rgba(255,255,255,0.03); padding: 15px; border-radius: 12px; margin: 15px 0; border: 1px dashed var(--border); font-family: monospace; font-size: 18px; letter-spacing: 1px; }

        /* --- NAV --- */
        .nav { position: fixed; bottom: 25px; left: 20px; right: 20px; background: rgba(15, 17, 26, 0.9); backdrop-filter: blur(15px); border: 1px solid var(--border); border-radius: 24px; display: flex; padding: 8px; justify-content: space-around; z-index: 1000; }
        .nav-link { display: flex; flex-direction: column; align-items: center; color: var(--text-dim); text-decoration: none; font-size: 10px; padding: 8px 0; width: 25%; transition: 0.3s; }
        .nav-link i { font-size: 20px; margin-bottom: 4px; }
        .nav-link.active { color: var(--text); }
        .nav-link.active i { color: var(--accent); }

    </style>
</head>
<body>

    <div class="header">
        <div style="font-weight: 800; font-size: 20px;">GENIUS<span>.</span></div>
        <div class="balance-chip">
            <i class="fas fa-wallet"></i>
            <span id="user-balance">0 ‚Ç∏</span>
        </div>
    </div>

    <div id="p-wa" class="page active">
        <div class="section-label">WhatsApp –ê–∫—Ç–∏–≤–∞—Ü–∏—è</div>
        <div id="list-wa"></div>
    </div>

    <div id="p-tg" class="page">
        <div class="section-label">Telegram –°–µ—Ä–≤–∏—Å—ã</div>
        <div id="list-tg"></div>
    </div>

    <div id="p-nft" class="page">
        <div class="section-label">NFT & Gifts</div>
        <div id="list-nft"></div>
    </div>

    <div id="p-profile" class="page">
        <div class="section-label">–ü—Ä–æ—Ñ–∏–ª—å</div>
        <div style="background:var(--surface); padding:20px; border-radius:20px; text-align:center">
            <h2 id="user-name">User</h2>
            <p id="user-id" style="color:var(--text-dim)">ID: 000000</p>
        </div>
    </div>

    <div class="modal-wrap" id="modal-pay" onclick="closePay()">
        <div class="modal-view" onclick="event.stopPropagation()">
            <div style="width:35px; height:4px; background:var(--border); margin:-15px auto 20px; border-radius:10px"></div>
            
            <div id="payment-methods">
                <h2 style="margin-top:0">–í—ã–±–æ—Ä –æ–ø–ª–∞—Ç—ã</h2>
                <p id="target-item" style="color:var(--text-dim); margin-bottom:20px">–¢–æ–≤–∞—Ä: -</p>

                <div class="pay-option" onclick="payKaspi()">
                    <div class="pay-icon kaspi-bg"><i class="fas fa-university"></i></div>
                    <div class="pay-info">
                        <b>Kaspi Gold</b>
                        <span>–ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ –∫–∞—Ä—Ç—É (‚Ç∏)</span>
                    </div>
                    <i class="fas fa-chevron-right" style="margin-left:auto; color:var(--text-dim)"></i>
                </div>

                <div class="pay-option" onclick="payStars()">
                    <div class="pay-icon stars-bg"><i class="fas fa-star"></i></div>
                    <div class="pay-info">
                        <b>Telegram Stars</b>
                        <span>–û–ø–ª–∞—Ç–∞ –∑–≤–µ–∑–¥–∞–º–∏ (Native)</span>
                    </div>
                    <i class="fas fa-chevron-right" style="margin-left:auto; color:var(--text-dim)"></i>
                </div>

                <div class="pay-option" onclick="payCrypto()">
                    <div class="pay-icon crypto-bg"><i class="fas fa-bolt"></i></div>
                    <div class="pay-info">
                        <b>Crypto /send</b>
                        <span>CryptoBot –ß–µ–∫–∏ (USDT/TON)</span>
                    </div>
                    <i class="fas fa-chevron-right" style="margin-left:auto; color:var(--text-dim)"></i>
                </div>
            </div>

            <div id="kaspi-checkout">
                <h2 style="color:var(--kaspi)">–û–ø–ª–∞—Ç–∞ Kaspi</h2>
                <p>–ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ —Ç–æ—á–Ω—É—é —Å—É–º–º—É –Ω–∞ –∫–∞—Ä—Ç—É:</p>
                <div class="copy-box" id="card-number" onclick="copyCard()">4400 4302 1234 5678</div>
                <p style="font-size:12px; color:var(--text-dim)">–ü–æ–ª—É—á–∞—Ç–µ–ª—å: –ì–ï–ù–ò–ô –ú. <br> –°—É–º–º–∞: <b id="final-price">0</b> ‚Ç∏</p>
                <button class="buy-btn" style="width:100%; padding:15px; margin-top:15px" onclick="confirmKaspi()">–Ø –û–ü–õ–ê–¢–ò–õ</button>
            </div>
        </div>
    </div>

    <nav class="nav">
        <a href="#" class="nav-link active" onclick="tab('p-wa', this)"><i class="fab fa-whatsapp"></i><span>WA</span></a>
        <a href="#" class="nav-link" onclick="tab('p-tg', this)"><i class="fab fa-telegram-plane"></i><span>TG</span></a>
        <a href="#" class="nav-link" onclick="tab('p-nft', this)"><i class="fas fa-gift"></i><span>NFT</span></a>
        <a href="#" class="nav-link" onclick="tab('p-profile', this)"><i class="fas fa-user"></i><span>–ü—Ä–æ—Ñ–∏–ª—å</span></a>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        const DATABASE = {
            wa: [
                {n: "–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω (+7)", p: 1200, i: "üá∞üáø"},
                {n: "–°–®–ê (–§–∏–∑–∏—á–µ—Å–∫–∏–π)", p: 1800, i: "üá∫üá∏"},
                {n: "–†–æ—Å—Å–∏—è (–í–∏—Ä—Ç)", p: 650, i: "üá∑üá∫"}
            ],
            tg: [
                {n: "Premium 1 –º–µ—Å", p: 3200, i: "‚≠ê"},
                {n: "Telegram Stars (100)", p: 1400, i: "‚ú®"}
            ],
            nft: [
                {n: "Faith Amulet Gift", p: 85000, i: "üßø"},
                {n: "Major NFT Token", p: 12000, i: "ü•á"}
            ]
        };

        let currentProduct = null;

        function init() {
            render('list-wa', DATABASE.wa);
            render('list-tg', DATABASE.tg);
            render('list-nft', DATABASE.nft);
            
            if(tg.initDataUnsafe.user) {
                document.getElementById('user-name').innerText = tg.initDataUnsafe.user.first_name;
                document.getElementById('user-id').innerText = "ID: " + tg.initDataUnsafe.user.id;
            }
        }

        function render(id, items) {
            document.getElementById(id).innerHTML = items.map(item => `
                <div class="card">
                    <div style="display:flex; align-items:center; gap:15px">
                        <div class="p-icon">${item.i}</div>
                        <div><b>${item.n}</b><br><small style="color:var(--text-dim)">–î–æ—Å—Ç—É–ø–Ω–æ</small></div>
                    </div>
                    <div style="text-align:right">
                        <div class="price-text">${item.p} ‚Ç∏</div>
                        <button class="buy-btn" onclick="startPay('${item.n}', ${item.p})">–ö–£–ü–ò–¢–¨</button>
                    </div>
                </div>
            `).join('');
        }

        function startPay(name, price) {
            currentProduct = { name, price };
            document.getElementById('target-item').innerText = "–¢–æ–≤–∞—Ä: " + name;
            document.getElementById('final-price').innerText = price;
            
            // –°–±—Ä–æ—Å –º–æ–¥–∞–ª–∫–∏
            document.getElementById('payment-methods').style.display = 'block';
            document.getElementById('kaspi-checkout').style.display = 'none';
            
            const modal = document.getElementById('modal-pay');
            modal.style.display = 'flex';
            setTimeout(() => modal.classList.add('active'), 10);
            tg.HapticFeedback.impactOccurred('medium');
        }

        function closePay() {
            const modal = document.getElementById('modal-pay');
            modal.classList.remove('active');
            setTimeout(() => modal.style.display = 'none', 300);
        }

        // –ú–ï–•–ê–ù–ò–ó–ú: KASPI GOLD
        function payKaspi() {
            document.getElementById('payment-methods').style.display = 'none';
            document.getElementById('kaspi-checkout').style.display = 'block';
            tg.HapticFeedback.impactOccurred('light');
        }

        function copyCard() {
            const num = document.getElementById('card-number').innerText;
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∫–æ–ø–∏—Ä—É–µ–º –≤ –±—É—Ñ–µ—Ä
            tg.showAlert("–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω: " + num);
            tg.HapticFeedback.notificationOccurred('success');
        }

        function confirmKaspi() {
            tg.showConfirm("–í—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ " + currentProduct.price + " ‚Ç∏? –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –ø—Ä–æ–≤–µ—Ä–∏—Ç –ø–ª–∞—Ç–µ–∂.", (ok) => {
                if(ok) {
                    tg.sendData(JSON.stringify({
                        method: "kaspi",
                        product: currentProduct.name,
                        amount: currentProduct.price
                    }));
                    closePay();
                }
            });
        }

        // –ú–ï–•–ê–ù–ò–ó–ú: TELEGRAM STARS (Native)
        function payStars() {
            const starsPrice = Math.ceil(currentProduct.price / 14); // –ü—Ä–∏–º–µ—Ä–Ω—ã–π –∫—É—Ä—Å 1 –∑–≤–µ–∑–¥–∞ = 14 —Ç–µ–Ω–≥–µ
            tg.showConfirm(`–û–ø–ª–∞—Ç–∏—Ç—å —á–µ—Ä–µ–∑ Telegram Stars (${starsPrice} ‚ú®)?`, (ok) => {
                if(ok) {
                    // –í —Ä–µ–∞–ª—å–Ω–æ–º –±–æ—Ç–µ –∑–¥–µ—Å—å –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è Bot API Invoice
                    tg.showAlert("–û—Ç–∫—Ä—ã–≤–∞—é –ø–ª–∞—Ç–µ–∂–Ω—ã–π —à–ª—é–∑ Stars...");
                    // tg.openInvoice(url); 
                }
            });
        }

        // –ú–ï–•–ê–ù–ò–ó–ú: CRYPTO /SEND
        function payCrypto() {
            tg.showPopup({
                title: 'Crypto Payment',
                message: '–û—Ç–ø—Ä–∞–≤—å—Ç–µ —á–µ–∫ CryptoBot –≤ —á–∞—Ç –±–æ—Ç—É –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /send.',
                buttons: [{text: '–û—Ç–∫—Ä—ã—Ç—å CryptoBot', id: 'cb'}]
            }, (id) => {
                if(id === 'cb') tg.openTelegramLink('https://t.me/CryptoBot');
            });
        }

        function tab(id, el) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            el.classList.add('active');
            tg.HapticFeedback.impactOccurred('light');
        }

        init();
        tg.ready();
    </script>
</body>
</html>
