<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Genius Market v4.0 | Industrial Digital Distribution</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@500;800;900&family=Manrope:wght@400;500;700;800&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-body: #020617;
            --bg-card: #0f172a;
            --bg-accent: #1e293b;
            --accent: #38bdf8;
            --accent-soft: rgba(56, 189, 248, 0.15);
            --text-main: #f8fafc;
            --text-dim: #64748b;
            --success: #10b981;
            --danger: #ef4444;
            --gold: #fbbf24;
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-font-smoothing: antialiased; }

        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            font-family: 'Manrope', sans-serif;
            line-height: 1.5;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .bg-glow {
            position: fixed; top: 0; left: 50%; transform: translateX(-50%);
            width: 100%; height: 500px;
            background: radial-gradient(circle at center, rgba(56, 189, 248, 0.08) 0%, transparent 70%);
            z-index: 0; pointer-events: none;
        }

        canvas#snow { position: fixed; inset: 0; z-index: 1; pointer-events: none; opacity: 0.3; }

        header {
            position: sticky; top: 0; z-index: 2000;
            background: rgba(2, 6, 23, 0.8); backdrop-filter: blur(20px);
            padding: 18px 24px; display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .logo { font-family: 'Unbounded'; font-weight: 800; font-size: 14px; letter-spacing: 1px; color: var(--accent); }
        .logo span { color: #fff; }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤–∞–ª—é—Ç—ã –∏ –±–∞–ª–∞–Ω—Å–∞ */
        .header-right { display: flex; align-items: center; gap: 10px; }

        /* –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∞–ª—é—Ç—ã */
        .currency-switch {
            background: var(--bg-accent);
            padding: 8px 12px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            font-size: 11px;
            font-weight: 800;
            color: #fff;
            cursor: pointer;
            transition: var(--transition);
        }
        .currency-switch:active { transform: scale(0.9); }

        .balance-chip {
            background: var(--bg-card); padding: 8px 14px; border-radius: 12px;
            border: 1px solid var(--accent-soft); display: flex; align-items: center; gap: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
        }

        .app-content { position: relative; z-index: 10; padding-bottom: 120px; }
        .screen { display: none; padding: 20px; animation: fadeIn 0.4s ease forwards; }
        .screen.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

        /* –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –ë–õ–û–ö –ö–ê–¢–ï–ì–û–†–ò–ô (4 –í –†–Ø–î) */
        .category-grid { 
            display: grid; 
            grid-template-columns: repeat(4, 1fr); 
            gap: 10px; 
            margin-bottom: 25px; 
        }
        .cat-item {
            background: var(--bg-card); 
            border-radius: 16px; 
            padding: 15px 5px; 
            text-align: center;
            border: 1px solid rgba(255,255,255,0.05); 
            cursor: pointer;
            transition: var(--transition);
        }
        .cat-item:active { transform: scale(0.9); background: var(--bg-accent); }
        .cat-item i { font-size: 22px; margin-bottom: 8px; display: block; }
        .cat-item .cat-label { 
            font-size: 9px; 
            font-weight: 700; 
            text-transform: uppercase; 
            color: var(--text-dim); 
            display: block;
        }

        .product-card {
            background: var(--bg-card); border-radius: 24px; padding: 20px; margin-bottom: 16px;
            border: 1px solid rgba(255,255,255,0.04); transition: var(--transition);
        }
        .product-card:active { border-color: var(--accent); }
        
        .p-header { display: flex; justify-content: space-between; margin-bottom: 12px; }
        .p-title { font-size: 15px; font-weight: 800; color: #fff; max-width: 70%; line-height: 1.3; }
        .p-price { font-family: 'Unbounded'; color: var(--accent); font-size: 16px; font-weight: 800; }

        .p-badges { display: flex; gap: 6px; margin-bottom: 14px; flex-wrap: wrap; }
        .tag { font-size: 9px; font-weight: 800; padding: 5px 10px; border-radius: 8px; text-transform: uppercase; letter-spacing: 0.5px; }
        .tag-gray { background: rgba(255,255,255,0.05); color: var(--text-dim); }
        .tag-success { background: rgba(16, 185, 129, 0.1); color: var(--success); }

        .p-desc { font-size: 12px; color: var(--text-dim); margin-bottom: 20px; line-height: 1.5; }

        .action-btn {
            width: 100%; padding: 16px; border-radius: 18px; border: none;
            background: var(--accent); color: #000; font-family: 'Unbounded';
            font-size: 12px; font-weight: 800; cursor: pointer; transition: var(--transition);
            box-shadow: 0 8px 20px rgba(56, 189, 248, 0.2);
        }
        .action-btn:active { transform: translateY(2px); box-shadow: none; }

        .wallet-hero {
            background: linear-gradient(160deg, #0f172a 0%, #020617 100%);
            padding: 40px 24px; border-radius: 32px; border: 1px solid var(--accent-soft);
            text-align: center; margin-bottom: 24px; box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        .w-balance { font-family: 'Unbounded'; font-size: 42px; font-weight: 900; margin: 10px 0; }
        
        nav {
            position: fixed; bottom: 30px; left: 20px; right: 20px;
            background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(15px);
            height: 72px; border-radius: 24px; display: flex; align-items: center;
            border: 1px solid rgba(255,255,255,0.08); z-index: 3000;
        }
        .nav-item { flex: 1; text-align: center; color: var(--text-dim); text-decoration: none; transition: 0.3s; display: flex; flex-direction: column; align-items: center; gap: 4px; }
        .nav-item.active { color: var(--accent); }
        .nav-item i { font-size: 20px; }
        .nav-item span { font-size: 10px; font-weight: 800; text-transform: uppercase; letter-spacing: 0.5px; }

        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.85);
            display: none; align-items: center; justify-content: center; z-index: 5000; padding: 20px;
            backdrop-filter: blur(10px);
        }
        .modal-card {
            background: var(--bg-card); width: 100%; max-width: 380px; border-radius: 32px;
            padding: 30px; border: 1px solid var(--accent-soft); text-align: center;
        }
        .modal-input {
            width: 100%; background: #000; border: 2px solid var(--accent-soft);
            padding: 20px; border-radius: 20px; color: #fff; font-size: 28px;
            font-family: 'Unbounded'; text-align: center; margin: 25px 0; outline: none;
        }
        .modal-input:focus { border-color: var(--accent); }

    </style>
</head>
<body>

<div class="bg-glow"></div>
<canvas id="snow"></canvas>

<header>
    <div class="logo">GENIUS <span>MARKET</span></div>
    <div class="header-right">
        <div class="currency-switch" id="currency-btn" onclick="App.toggleCurrency()">KZT</div>
        <div class="balance-chip">
            <span id="top-balance" style="font-weight: 800;">0</span>
            <span id="top-symbol" style="font-size: 10px; color: var(--accent); font-weight: 900;">‚Ç∏</span>
        </div>
    </div>
</header>

<div class="app-content">
    
    <section id="market-screen" class="screen active">
        <div class="category-grid">
            <div class="cat-item" onclick="App.openCat('Telegram')">
                <i class="fa-brands fa-telegram" style="color:var(--accent)"></i>
                <span class="cat-label">Telegram</span>
            </div>
            <div class="cat-item" onclick="App.openCat('Steam')">
                <i class="fa-brands fa-steam" style="color:#ffffff"></i>
                <span class="cat-label">Steam</span>
            </div>
            <div class="cat-item" onclick="App.openCat('Spotify')">
                <i class="fa-brands fa-spotify" style="color:#1DB954"></i>
                <span class="cat-label">Spotify</span>
            </div>
            <div class="cat-item" onclick="App.openCat('Discord')">
                <i class="fa-brands fa-discord" style="color:#5865F2"></i>
                <span class="cat-label">Discord</span>
            </div>
            <div class="cat-item" onclick="App.openCat('TikTok')">
                <i class="fa-brands fa-tiktok" style="color:#ffffff"></i>
                <span class="cat-label">TikTok</span>
            </div>
            <div class="cat-item" onclick="App.openCat('Instagram')">
                <i class="fa-brands fa-instagram" style="color:#E1306C"></i>
                <span class="cat-label">Instagram</span>
            </div>
            <div class="cat-item" onclick="App.openCat('WhatsApp')">
                <i class="fa-brands fa-whatsapp" style="color:#25D366"></i>
                <span class="cat-label">WhatsApp</span>
            </div>
            <div class="cat-item" onclick="App.openCat('VPN')">
                <i class="fa-solid fa-shield-halved" style="color:var(--accent)"></i>
                <span class="cat-label">VPN</span>
            </div>
        </div>

        <h3 style="font-family: 'Unbounded'; font-size: 12px; margin-bottom: 20px; color: var(--accent);">üî• –•–ò–¢–´ –ü–†–û–î–ê–ñ</h3>
        <div id="popular-render"></div>
    </section>

    <section id="category-screen" class="screen">
        <div onclick="App.nav('market-screen')" style="color: var(--text-dim); font-weight: 800; font-size: 13px; margin-bottom: 25px; display: flex; align-items: center; gap: 8px;">
            <i class="fa-solid fa-arrow-left-long"></i> –ù–ê–ó–ê–î –í –ú–ï–ù–Æ
        </div>
        <h2 id="cat-title" style="font-family: 'Unbounded'; font-size: 24px; margin-bottom: 25px;">–ö–ê–¢–ï–ì–û–†–ò–Ø</h2>
        <div id="cat-render"></div>
    </section>

    <section id="wallet-screen" class="screen">
        <div class="wallet-hero">
            <span style="font-size: 11px; font-weight: 800; color: var(--text-dim); letter-spacing: 2px;">–¢–ï–ö–£–©–ò–ô –ë–ê–õ–ê–ù–°</span>
            <div class="w-balance"><span id="w-val">0</span><span class="curr-sym" style="color: var(--accent); font-size: 20px; margin-left: 8px;">‚Ç∏</span></div>
            <p id="user-id" style="font-size: 10px; color: var(--text-dim); margin-top: 10px; font-weight: 700;">USER ID: ---</p>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 30px;">
            <button class="action-btn" onclick="App.toggleModal(true)" style="background: #fff; box-shadow: none;">–ü–û–ü–û–õ–ù–ò–¢–¨</button>
            <button class="action-btn" style="background: var(--bg-accent); color: #fff; box-shadow: none; border: 1px solid rgba(255,255,255,0.05);">–í–´–í–û–î</button>
        </div>

        <div style="background: var(--bg-card); border-radius: 24px; padding: 25px; border: 1px dashed rgba(255,255,255,0.1); text-align: center;">
            <i class="fa-solid fa-clock-rotate-left" style="font-size: 24px; color: var(--bg-accent); margin-bottom: 12px;"></i>
            <p style="font-size: 12px; color: var(--text-dim);">–ò—Å—Ç–æ—Ä–∏—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π –ø—É—Å—Ç–∞</p>
        </div>
    </section>

    <section id="profile-screen" class="screen">
        <div style="text-align: center; margin: 20px 0 40px;">
            <div style="width: 110px; height: 110px; border-radius: 40px; background: var(--bg-card); border: 2px solid var(--accent); margin: 0 auto 20px; transform: rotate(-5deg); display: flex; align-items: center; justify-content: center; font-size: 40px; color: var(--accent); box-shadow: 0 15px 30px var(--accent-soft);">
                <i class="fa-solid fa-bolt" style="transform: rotate(5deg);"></i>
            </div>
            <h2 id="u-name" style="font-family: 'Unbounded'; font-size: 20px;">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h2>
            <p style="color: var(--success); font-size: 11px; font-weight: 800; text-transform: uppercase; margin-top: 5px;">–°—Ç–∞—Ç—É—Å: Active Client</p>
        </div>

        <div style="background: var(--bg-card); border-radius: 28px; padding: 20px;">
            <div style="display: flex; justify-content: space-between; align-items: center; padding-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.05);">
                <span style="font-size: 13px; color: var(--text-dim);">–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</span>
                <span style="font-weight: 800;">0 —à—Ç.</span>
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px 0;">
                <span style="font-size: 13px; color: var(--text-dim);">–û–±—â–∞—è —Å—É–º–º–∞</span>
                <span id="profile-total" style="font-weight: 800; color: var(--accent);">0 ‚Ç∏</span>
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 15px;">
                <span style="font-size: 13px; color: var(--text-dim);">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</span>
                <span style="font-weight: 800; color: var(--gold);">@k3vinmaccalister</span>
            </div>
        </div>
    </section>

</div>

<div class="modal-overlay" id="modal-pay">
    <div class="modal-card">
        <h3 style="font-family: 'Unbounded'; font-size: 16px;">–ü–û–ü–û–õ–ù–ï–ù–ò–ï</h3>
        <p style="font-size: 12px; color: var(--text-dim); margin-top: 8px;">–ß–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É <b>Crypto Pay (@send)</b></p>
        
        <input type="number" id="pay-input" class="modal-input" placeholder="0" autofocus>
        
        <button class="action-btn" onclick="App.createInvoice()" style="padding: 20px; font-size: 14px;">–°–û–ó–î–ê–¢–¨ –°–ß–ï–¢</button>
        <button onclick="App.toggleModal(false)" style="background: transparent; border: none; color: var(--text-dim); margin-top: 20px; font-weight: 700; font-size: 12px;">–û–¢–ú–ï–ù–ê</button>
    </div>
</div>

<nav>
    <a href="javascript:void(0)" class="nav-item active" onclick="App.nav('market-screen', this)"><i class="fa-solid fa-house-chimney-window"></i><span>–ì–ª–∞–≤–Ω–∞—è</span></a>
    <a href="javascript:void(0)" class="nav-item" onclick="App.nav('wallet-screen', this)"><i class="fa-solid fa-wallet"></i><span>–ö–æ—à–µ–ª–µ–∫</span></a>
    <a href="javascript:void(0)" class="nav-item" onclick="App.nav('profile-screen', this)"><i class="fa-solid fa-user-ninja"></i><span>–ü—Ä–æ—Ñ–∏–ª—å</span></a>
</nav>

<script>
const DB = {
    'Telegram': [
        { name: '–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω (+7) | Tdata | –§–∏–∑–∏—á–µ—Å–∫–∞—è –°–∏–º-–ö–∞—Ä—Ç–∞', price: 1500, tags: ['–° –æ—Ç–ª–µ–≥–æ–π', '–ê–≤—Ç–æ-—Ä–µ–≥'], desc: '–û—Ç–ª–µ–∂–∫–∞ –æ—Ç 6 –º–µ—Å—è—Ü–µ–≤. –ù–æ–º–µ—Ä–∞ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞. –ß–∏—Å—Ç—ã–µ –ø—Ä–æ–∫—Å–∏.' },
        { name: '–†–æ—Å—Å–∏—è (+7) | Session | 2FA', price: 750, tags: ['Fast', 'Soft'], desc: '–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Ä–∞—Å—Å—ã–ª–æ–∫ –∏ –∏–Ω–≤–∞–π—Ç–∞. –ë–µ–∑ —Å–ø–∞–º–±–ª–æ–∫–∞.' },
        { name: 'USA (+1) | –†–µ–∞–ª—å–Ω—ã–µ –°–∏–º-–ö–∞—Ä—Ç—ã', price: 1100, tags: ['Stable', 'USA'], desc: '–õ–∏—á–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –§–∏–∑–∏—á–µ—Å–∫–∏–π –°–∏–º-–ö–∞—Ä—Ç—ã –ê–º–µ—Ä–∏–∫–∏.' },
		{ name: '–í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è (+44) | –†–µ–∞–ª—å–Ω—ã–µ –°–∏–º-–ö–∞—Ä—Ç—ã', price: 1400, tags: ['Stable', 'UK'], desc: '–ù–µ –í–∞–ª–∏–¥ , –õ—é–±–æ–π —Å–ø–æ—Å–æ–± –≤—Ö–æ–¥–∞ , –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π.' },
		{ name: '–ë–∞–Ω–≥–ª–∞–¥–µ—à (+880) | TG-—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ', price: 470, tags: ['Telegram', 'Asia'], desc: '–≠–∫—Å–∫–ª—é–∑–∏–≤ –¥–ª—è Telegram ‚Ä¢ –ù–µ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ ‚Ä¢ –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –≤—ã–¥–∞—á–∞.' },
		{ name: '–ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω (+996) | Telegram –Ω–æ–º–µ—Ä–∞ ', price: 280, tags: ['Fast', 'KG'], desc: '–ù–∞–¥—ë–∂–Ω—ã–µ SIM, –ü–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è Telegram, –õ—ë–≥–∫–∏–π –≤—Ö–æ–¥.' },
		{ name: '–°–æ–º–∞–ª–∏ (+252)  | Telegram –Ω–æ–º–µ—Ä–∞ ', price: 280, tags: ['Fast', 'SO'], desc: '–ù–∞–¥—ë–∂–Ω—ã–µ SIM, –ü–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è Telegram, –ù–µ –∏—Å–ø–æ–ª—å–∑—É—é.' },
		{ name: '–ï–≥–∏–ø–µ—Ç (+20)  | Telegram –Ω–æ–º–µ—Ä–∞ ', price: 600, tags: ['Fast', 'EG'], desc: '–ü–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è Telegram, –õ—ë–≥–∫–∏–π –≤—Ö–æ–¥, –û—Ç–ª–µ–≥–∞ 6 –≥–æ–¥.' }
    ],
    'WhatsApp': [
        { name: 'WA Business | –ò–Ω–¥–æ–Ω–µ–∑–∏—è (+62)', price: 2200, tags: ['Business', 'API'], desc: '–ê–∫–∫–∞—É–Ω—Ç—ã –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫. –í—ã—Å–æ–∫–∏–π –ª–∏–º–∏—Ç.' },
        { name: 'WA –õ–∏—á–Ω—ã–π | –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω (+7)', price: 3500, tags: ['Real', 'KZ'], desc: '–§–∏–∑. —Å–∏–º –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω. –†—É—á–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è.' },
        { name: 'WA –ê–≤—Ç–æ—Ä–µ–≥ | –ò–Ω–¥–∏—è (+91)', price: 800, tags: ['Cheap'], desc: '–ë—é–¥–∂–µ—Ç–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á.' }
    ],
    'TikTok': [
        { name: 'TikTok USA | –î–æ—Å—Ç—É–ø –∫ –°—Ç—Ä–∏–º–∞–º', price: 1200, tags: ['Live', 'USA'], desc: '–ê–∫–∫–∞—É–Ω—Ç—ã —Å –æ—Ç–∫—Ä—ã—Ç—ã–º Live-–¥–æ—Å—Ç—É–ø–æ–º –∏ Creator Program.' },
        { name: 'TikTok Ads | –ê–≥–µ–Ω—Ç—Å–∫–∏–π –∫–∞–±–∏–Ω', price: 4500, tags: ['Ads', 'Business'], desc: '–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Ä–µ–∫–ª–∞–º—ã –Ω–∞ –ª—é–±—ã–µ –ì–ï–û.' },
        { name: 'TikTok 1k+ –ü–æ–¥–ø–∏—Å—á–∏–∫–æ–≤', price: 2800, tags: ['High Stats'], desc: '–ê–∫–∫–∞—É–Ω—Ç—ã —Å –∂–∏–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–µ–π.' },
        { name: 'TikTok –ü—Ä–æ–≥—Ä–µ—Ç—ã–π | RU IP', price: 500, tags: ['Warm-up'], desc: '–î–ª—è –∑–∞–ª–∏–≤–∞ –≤–∏–¥–µ–æ, —Ö–æ—Ä–æ—à–∏–µ –æ—Ö–≤–∞—Ç—ã.' }
    ],
    'Discord': [
        { name: 'Discord Nitro (Gift) | 1 Year', price: 18000, tags: ['Full Access'], desc: '–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ –≥–∏—Ñ—Ç–æ–º –Ω–∞ –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç.' },
        { name: 'Discord –¢–æ–∫–µ–Ω—ã | –ü–æ—á—Ç–∞+–¢–µ–ª', price: 150, tags: ['Verified'], desc: '–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –¥–ª—è —Å–ø–∞–º–∞.' },
        { name: 'Discord –ê–∫–∫–∞—É–Ω—Ç | 2017 –ì–æ–¥', price: 4200, tags: ['Old School'], desc: '–†–∞—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã —Å –±–æ–ª—å—à–æ–π –æ—Ç–ª–µ–∂–∫–æ–π.' }
    ],
    'VPN': [
        { name: 'Genius VPN | 2026 Premium', price: 5000, tags: ['Fast', 'No Logs'], desc: '–ù–∞—à —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å. 100+ —Å—Ç—Ä–∞–Ω, –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.' }
    ],
    'Steam': [
        { name: 'Steam Turkey | –°–º–µ–Ω–∞ —Ä–µ–≥–∏–æ–Ω–∞', price: 1400, tags: ['Region'], desc: '–ü–µ—Ä–µ–≤–æ–¥ –≤–∞—à–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –Ω–∞ —Ä–µ–≥–∏–æ–Ω –¢—É—Ä—Ü–∏—è.' }
    ],
    'Spotify': [
        { name: 'Spotify Premium 12 –º–µ—Å', price: 8500, tags: ['Premium'], desc: '–ê–∫—Ç–∏–≤–∞—Ü–∏—è –Ω–∞ –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç.' }
    ],
    'Instagram': [
        { name: 'Insta 2015-2018', price: 900, tags: ['Old'], desc: '–ê–∫–∫–∞—É–Ω—Ç—ã —Å –±–æ–ª—å—à–æ–π –æ—Ç–ª–µ–∂–∫–æ–π.' }
    ]
};

const tg = window.Telegram.WebApp;

const App = {
    // –õ–û–ì–ò–ö–ê –í–ê–õ–Æ–¢
    currentCurrency: 'KZT',
    rates: { 'KZT': 1, 'RUB': 0.19, 'USD': 0.0021 }, // –ü—Ä–∏–º–µ—Ä–Ω—ã–µ –∫—É—Ä—Å—ã
    symbols: { 'KZT': '‚Ç∏', 'RUB': '‚ÇΩ', 'USD': '$' },

    init() {
        tg.expand();
        this.renderPopular();
        this.initSnow();
        this.syncUser();
        this.updateCurrencyUI();
        setTimeout(() => tg.ready(), 500);
    },

    toggleCurrency() {
        const order = ['KZT', 'RUB', 'USD'];
        let idx = order.indexOf(this.currentCurrency);
        this.currentCurrency = order[(idx + 1) % order.length];
        
        document.getElementById('currency-btn').innerText = this.currentCurrency;
        this.updateCurrencyUI();
        
        // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π —ç–∫—Ä–∞–Ω –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω
        this.renderPopular();
        const catTitle = document.getElementById('cat-title').innerText;
        if (catTitle && catTitle !== '–ö–ê–¢–ï–ì–û–†–ò–Ø') {
            // –ù–∞—Ö–æ–¥–∏–º –∫–ª—é—á –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ —Ç–µ–∫—Å—Ç—É –∑–∞–≥–æ–ª–æ–≤–∫–∞
            const catKey = Object.keys(DB).find(k => k.toUpperCase() === catTitle);
            if (catKey) this.renderItems(DB[catKey], 'cat-render');
        }

        tg.HapticFeedback.impactOccurred('light');
    },

    updateCurrencyUI() {
        const sym = this.symbols[this.currentCurrency];
        document.getElementById('top-symbol').innerText = sym;
        document.querySelectorAll('.curr-sym').forEach(el => el.innerText = sym);
        document.getElementById('profile-total').innerText = `0 ${sym}`;
    },

    getConvertedPrice(priceKzt) {
        const rate = this.rates[this.currentCurrency];
        const sym = this.symbols[this.currentCurrency];
        const final = (priceKzt * rate);
        
        // –î–ª—è USD –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ—Ç—ã–µ, –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ü–µ–ª—ã–µ
        const formatted = this.currentCurrency === 'USD' ? final.toFixed(2) : Math.ceil(final).toLocaleString();
        return `${formatted} ${sym}`;
    },

    syncUser() {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—ã –≤–Ω—É—Ç—Ä–∏ Telegram
        if(window.Telegram.WebApp.initDataUnsafe?.user) {
            const u = window.Telegram.WebApp.initDataUnsafe.user;
            
            // –õ–æ–≥–∏–∫–∞: –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–∏–∫ (@login), –±–µ—Ä–µ–º –µ–≥–æ. 
            // –ï—Å–ª–∏ –Ω–∏–∫–∞ –Ω–µ—Ç, –±–µ—Ä–µ–º –ò–º—è. 
            // –ï—Å–ª–∏ –∏ –∏–º–µ–Ω–∏ –Ω–µ—Ç (–±—ã–≤–∞–µ—Ç —Ä–µ–¥–∫–æ), –æ—Å—Ç–∞–≤–ª—è–µ–º "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å".
            const userDisplay = u.username ? `@${u.username}` : (u.first_name || "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å");
            
            // –ù–∞—Ö–æ–¥–∏–º —Ç–æ—Ç —Å–∞–º—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ h2 –∏ –º–µ–Ω—è–µ–º –≤ –Ω–µ–º —Ç–µ–∫—Å—Ç
            document.getElementById('u-name').innerText = userDisplay;
            document.getElementById('user-id').innerText = `USER ID: ${u.id}`;
        }
    },
        }
    },

    nav(id, el) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        if(el) {
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            el.classList.add('active');
        }
        tg.HapticFeedback.impactOccurred('medium');
        window.scrollTo(0,0);
    },

    openCat(name) {
        document.getElementById('cat-title').innerText = name.toUpperCase();
        this.renderItems(DB[name] || [], 'cat-render');
        this.nav('category-screen');
    },

    renderItems(items, targetId) {
        const container = document.getElementById(targetId);
        if(!items.length) {
            container.innerHTML = '<p style="color:var(--text-dim); text-align:center;">–¢–æ–≤–∞—Ä—ã —Å–∫–æ—Ä–æ –ø–æ—è–≤—è—Ç—Å—è...</p>';
            return;
        }
        container.innerHTML = items.map(i => `
            <div class="product-card">
                <div class="p-header">
                    <span class="p-title">${i.name}</span>
                    <span class="p-price">${this.getConvertedPrice(i.price)}</span>
                </div>
                <div class="p-badges">
                    ${i.tags.map(t => `<span class="tag tag-gray">${t}</span>`).join('')}
                    <span class="tag tag-success">–ë–ï–ó –°–ü–ê–ú–ë–õ–û–ö–ê</span>
                </div>
                <p class="p-desc">${i.desc}</p>
                <button class="action-btn" onclick="App.buy('${i.name}', ${i.price})">–û–§–û–†–ú–ò–¢–¨ –ó–ê–ö–ê–ó</button>
            </div>
        `).join('');
    },

    renderPopular() {
        const hits = [...DB['Telegram'], ...DB['TikTok']].filter((_, idx) => idx % 2 === 0);
        this.renderItems(hits, 'popular-render');
    },

    buy(name, priceKzt) {
        const displayPrice = this.getConvertedPrice(priceKzt);
        tg.showConfirm(`–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–æ–∫—É–ø–∫—É ${name} –∑–∞ ${displayPrice}?`, (ok) => {
            if(ok) tg.showAlert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–æ—à–µ–ª–µ–∫.");
        });
    },

    toggleModal(show) {
        document.getElementById('modal-pay').style.display = show ? 'flex' : 'none';
        if(show) tg.HapticFeedback.impactOccurred('light');
    },

    createInvoice() {
        const val = document.getElementById('pay-input').value;
        if(!val || val < 600) return tg.showAlert("–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ ‚Äî 600 ‚Ç∏");

        tg.showConfirm(`–°–æ–∑–¥–∞—Ç—å —Å—á–µ—Ç –Ω–∞ ${val} ‚Ç∏ —á–µ—Ä–µ–∑ @send?\n–ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –±–æ—Ç –ø—Ä–∏—à–ª–µ—Ç –≤–∞–º —Å—Å—ã–ª–∫—É –Ω–∞ –æ–ø–ª–∞—Ç—É.`, (ok) => {
            if(ok) {
                tg.sendData(JSON.stringify({ type: "deposit", method: "crypto_pay", amount: val }));
                this.toggleModal(false);
            }
        });
    },

    initSnow() {
        const canvas = document.getElementById('snow');
        const ctx = canvas.getContext('2d');
        let flakes = [];
        const resize = () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; };
        window.addEventListener('resize', resize);
        resize();
        for(let i=0; i<50; i++) flakes.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height, r: Math.random()*2+0.5, s: Math.random()*0.5+0.2 });
        const loop = () => {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            ctx.fillStyle = "white";
            ctx.beginPath();
            flakes.forEach(f => {
                ctx.moveTo(f.x, f.y); ctx.arc(f.x, f.y, f.r, 0, Math.PI*2);
                f.y += f.s; if(f.y > canvas.height) f.y = -5;
            });
            ctx.fill(); requestAnimationFrame(loop);
        };
        loop();
    }
};

App.init();
</script>
</body>
</html>
