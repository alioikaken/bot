<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>GENIUS MARKET ULTIMATE</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">
    
    <style>
        /* PROFESSIONAL STYLING ENGINE 
           1000+ LINES LOGIC EQUIVALENT 
        */
        :root {
            --tg-theme-bg: #0f0f0f;
            --accent: #007aff;
            --gold: #ffcc00;
            --glass: rgba(255, 255, 255, 0.05);
            --border: rgba(255, 255, 255, 0.1);
            --grad: linear-gradient(135deg, #1e1e1e 0%, #111 100%);
        }

        body {
            margin: 0; background: var(--tg-theme-bg); color: white;
            font-family: 'Montserrat', sans-serif; -webkit-user-select: none;
            overflow: hidden; height: 100vh;
        }

        /* АНИМИРОВАННЫЙ ФОН */
        .bg-blur {
            position: fixed; top: -50px; right: -50px; width: 200px; height: 200px;
            background: var(--accent); filter: blur(120px); opacity: 0.3; z-index: -1;
        }

        /* HEADER */
        header {
            padding: 20px; display: flex; justify-content: space-between; align-items: center;
            background: rgba(0,0,0,0.5); backdrop-filter: blur(15px); border-bottom: 1px solid var(--border);
        }
        .logo-area { display: flex; align-items: center; gap: 10px; font-weight: 800; font-size: 18px; }
        .logo-img { width: 32px; height: 32px; border-radius: 8px; }

        .balance-pill {
            background: var(--glass); padding: 8px 15px; border-radius: 20px;
            display: flex; align-items: center; gap: 8px; border: 1px solid var(--border);
        }
        .balance-pill span { color: var(--gold); font-weight: 800; }

        /* VIEWPORT */
        .content-scroll {
            height: calc(100vh - 150px); overflow-y: auto; padding: 15px;
            padding-bottom: 100px;
        }

        /* КАРТОЧКИ ТОВАРОВ (РЕАЛЬНЫЕ КАРТИНКИ) */
        .product-card {
            background: var(--grad); border-radius: 20px; padding: 15px; margin-bottom: 12px;
            border: 1px solid var(--border); display: flex; align-items: center; gap: 15px;
            position: relative; overflow: hidden;
        }
        .product-image {
            width: 70px; height: 70px; border-radius: 15px; object-fit: cover;
            border: 1px solid var(--border);
        }
        .product-info h3 { margin: 0; font-size: 16px; margin-bottom: 5px; }
        .product-info p { margin: 0; font-size: 12px; color: #aaa; }

        .price-tag {
            margin-left: auto; text-align: right;
        }
        .price-val { color: var(--gold); font-weight: 800; font-size: 16px; display: block; }
        .buy-btn {
            background: var(--accent); color: white; border: none; padding: 5px 12px;
            border-radius: 8px; font-size: 11px; margin-top: 5px; font-weight: 600;
        }

        /* КАСПИ АВТОМАТИЗАЦИЯ (ИМИТАЦИЯ) */
        .kaspi-badge {
            position: absolute; top: 0; right: 0; background: #f14635;
            padding: 2px 10px; font-size: 9px; border-bottom-left-radius: 10px; font-weight: 800;
        }

        /* ПОДТВЕРЖДЕНИЕ (КАК НА СКРИНШОТЕ) */
        .overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.9);
            z-index: 9999; display: none; align-items: center; justify-content: center;
        }
        .confirm-box {
            width: 90%; background: #1a1a1a; border-radius: 30px; padding: 30px;
            text-align: center; border: 1px solid var(--border);
        }
        .confirm-icon {
            width: 80px; height: 80px; background: white; border-radius: 50%;
            margin: 0 auto 20px; display: flex; align-items: center; justify-content: center;
        }
        .confirm-title { font-size: 24px; font-weight: 800; margin-bottom: 15px; }
        .confirm-text { color: #aaa; margin-bottom: 25px; line-height: 1.5; }
        .btn-pay {
            width: 100%; padding: 18px; border-radius: 20px; border: none;
            background: #3390ec; color: white; font-weight: 800; font-size: 16px;
        }

        /* NAVIGATION BAR */
        .nav-bar {
            position: fixed; bottom: 20px; left: 15px; right: 15px;
            background: rgba(25, 25, 25, 0.9); backdrop-filter: blur(20px);
            border-radius: 25px; padding: 12px; display: flex; justify-content: space-around;
            border: 1px solid var(--border);
        }
        .nav-item {
            display: flex; flex-direction: column; align-items: center; gap: 5px;
            color: #666; font-size: 10px; font-weight: 600;
        }
        .nav-item i { font-size: 20px; }
        .nav-item.active { color: var(--accent); }

        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div class="bg-blur"></div>

    <header>
        <div class="logo-area">
            <img src="https://cdn-icons-png.flaticon.com/512/8112/8112534.png" class="logo-img">
            GENIUS PRO
        </div>
        <div class="balance-pill">
            <img src="https://cdn-icons-png.flaticon.com/512/1828/1828884.png" width="16">
            <span id="stars-balance">0</span>
        </div>
    </header>

    <div class="content-scroll">
        <div id="view-whatsapp">
            <h2 style="padding: 10px;">WhatsApp Номера</h2>
            <div class="product-grid" id="wa-list"></div>
        </div>

        <div id="view-telegram" class="hidden">
            <h2 style="padding: 10px;">Telegram Услуги</h2>
            <div class="product-grid" id="tg-list"></div>
        </div>

        <div id="view-profile" class="hidden">
            <div style="text-align: center; padding: 40px 20px;">
                <div style="width: 80px; height: 80px; background: var(--accent); border-radius: 50%; margin: 0 auto 15px;"></div>
                <h2 id="user-name">User</h2>
                <p id="user-id" style="color:#666">ID: 00000000</p>
                
                <div style="margin-top:30px; background:var(--glass); border-radius:15px; padding:20px; text-align:left;">
                    <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                        <span>Баланс:</span> <span style="color:var(--gold)">0 ₸</span>
                    </div>
                    <div style="display:flex; justify-content:space-between;">
                        <span>Статус:</span> <span style="color:#00ff00">VIP</span>
                    </div>
                </div>
            </div>
        </div>

        <div id="view-about" class="hidden">
            <div style="padding: 20px; line-height: 1.6;">
                <h2>О сервисе</h2>
                <p>Genius Market - это инновационная площадка для автоматизированной покупки цифровых товаров.</p>
                <p>Мы используем API лучших поставщиков мира, чтобы вы получали номера мгновенно.</p>
                <div style="margin-top:20px; border-left:4px solid var(--accent); padding-left:15px;">
                    <b>CEO & Support:</b> @k3vinmaccalister
                </div>
            </div>
        </div>
    </div>

    <div class="overlay" id="pay-overlay">
        <div class="confirm-box animate__animated animate__zoomIn">
            <div class="confirm-icon">
                <img src="https://cdn-icons-png.flaticon.com/512/8112/8112534.png" width="50">
            </div>
            <div class="confirm-title">Подтверждение</div>
            <div class="confirm-text">
                Вы точно хотите приобрести <br>
                <b id="buy-item-name" style="color:white">...</b> <br>
                у <b style="color:var(--accent)">GENIUS MARKET</b> за <span id="buy-item-price">0</span> звёзд?
            </div>
            <button class="btn-pay" onclick="processFinal()">Подтвердить и заплатить</button>
            <p onclick="closePay()" style="margin-top:20px; color:#666; font-size:14px; cursor:pointer;">Отмена</p>
        </div>
    </div>

    <div class="nav-bar">
        <div class="nav-item active" onclick="nav('whatsapp', this)"><i class="fa-brands fa-whatsapp"></i>WA</div>
        <div class="nav-item" onclick="nav('telegram', this)"><i class="fa-brands fa-telegram"></i>TG</div>
        <div class="nav-item" onclick="nav('profile', this)"><i class="fa-solid fa-circle-user"></i>Профиль</div>
        <div class="nav-item" onclick="nav('about', this)"><i class="fa-solid fa-circle-info"></i>О нас</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // ДАННЫЕ С КАРТИНКАМИ (ЗАМЕНА СТИКЕРОВ)
        const DATA = {
            wa: [
                { id: 101, name: "Марокко", price: 0.55, img: "https://flagcdn.com/w160/ma.png", stock: "1207 шт" },
                { id: 102, name: "Филиппины", price: 0.72, img: "https://flagcdn.com/w160/ph.png", stock: "5600 шт" },
                { id: 103, name: "Индонезия", price: 0.62, img: "https://flagcdn.com/w160/id.png", stock: "15278 шт" },
                { id: 104, name: "США", price: 5.0, img: "https://flagcdn.com/w160/us.png", stock: "7113 шт" }
            ],
            tg: [
                { id: 201, name: "Premium (1 мес)", price: 1400, img: "https://cdn-icons-png.flaticon.com/512/5968/5968804.png", stock: "∞" },
                { id: 202, name: "1000 Stars", price: 8200, img: "https://cdn-icons-png.flaticon.com/512/1828/1828884.png", stock: "10" }
            ]
        };

        function render() {
            const waList = document.getElementById('wa-list');
            const tgList = document.getElementById('tg-list');

            DATA.wa.forEach(i => {
                waList.innerHTML += `
                    <div class="product-card">
                        <div class="kaspi-badge">KASPI AUTO</div>
                        <img src="${i.img}" class="product-image">
                        <div class="product-info">
                            <h3>${i.name}</h3>
                            <p>Доступно: ${i.stock}</p>
                        </div>
                        <div class="price-tag">
                            <span class="price-val">$ ${i.price}</span>
                            <button class="buy-btn" onclick="openPay('${i.name}', ${i.price})">КУПИТЬ</button>
                        </div>
                    </div>
                `;
            });

            DATA.tg.forEach(i => {
                tgList.innerHTML += `
                    <div class="product-card">
                        <img src="${i.img}" class="product-image">
                        <div class="product-info">
                            <h3>${i.name}</h3>
                            <p>Мгновенная выдача</p>
                        </div>
                        <div class="price-tag">
                            <span class="price-val">${i.price} ₸</span>
                            <button class="buy-btn" onclick="openPay('${i.name}', ${i.price})">КУПИТЬ</button>
                        </div>
                    </div>
                `;
            });
        }

        function nav(view, el) {
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            el.classList.add('active');
            
            ['whatsapp', 'telegram', 'profile', 'about'].forEach(v => {
                document.getElementById('view-'+v).classList.add('hidden');
            });
            document.getElementById('view-'+view).classList.remove('hidden');
            tg.HapticFeedback.impactOccurred('light');
        }

        function openPay(name, price) {
            document.getElementById('buy-item-name').innerText = name;
            document.getElementById('buy-item-price').innerText = price;
            document.getElementById('pay-overlay').style.display = 'flex';
            tg.HapticFeedback.impactOccurred('medium');
        }

        function closePay() {
            document.getElementById('pay-overlay').style.display = 'none';
        }

        function processFinal() {
            tg.showConfirm("Выполнить списание средств?");
            closePay();
            // Здесь отправка данных в Python
            tg.sendData(JSON.stringify({action: "buy", item: document.getElementById('buy-item-name').innerText}));
        }

        window.onload = () => {
            render();
            if(tg.initDataUnsafe.user) {
                document.getElementById('user-name').innerText = tg.initDataUnsafe.user.first_name;
                document.getElementById('user-id').innerText = 'ID: ' + tg.initDataUnsafe.user.id;
            }
        };
    </script>
</body>
</html>
